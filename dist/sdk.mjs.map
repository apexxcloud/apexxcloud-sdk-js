{"version":3,"file":"sdk.mjs","sources":["../src/sdk.js"],"sourcesContent":["class ApexxCloud {\n  constructor(config = {}) {\n    this.config = {\n      baseUrl: config.baseUrl || \"https://api.apexxcloud.com\",\n    };\n\n    // Initialize API clients\n    this.files = {\n      upload: this.uploadFile.bind(this),\n      uploadMultipart: this.uploadMultipart.bind(this),\n    };\n  }\n\n  async uploadMultipart(\n    file,\n    getSignedUrl,\n    {\n      onProgress = () => {},\n      onPartComplete = () => {},\n      onComplete = () => {},\n      onError = () => {},\n      partSize = 5 * 1024 * 1024,\n      signal,\n      concurrency = 3,\n    } = {}\n  ) {\n    let uploadId;\n    try {\n      // Start multipart upload\n      const startUrl = await getSignedUrl(\"start-multipart\", {\n        key: file.name,\n        totalParts: Math.ceil(file.size / partSize),\n        mimeType: file.type,\n      });\n\n      const startUpload = () =>\n        new Promise((resolve, reject) => {\n          const xhr = new XMLHttpRequest();\n\n          if (signal?.aborted) {\n            onError({\n              type: \"abort\",\n              error: new Error(\"Upload aborted\"),\n              phase: \"start\",\n              timestamp: new Date(),\n            });\n            reject(new Error(\"Upload aborted\"));\n            return;\n          }\n\n          xhr.open(\"POST\", startUrl);\n          xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n\n          xhr.onload = () => {\n            if (xhr.status >= 200 && xhr.status < 300) {\n              try {\n                resolve(JSON.parse(xhr.responseText));\n              } catch (e) {\n                const error = new Error(\n                  \"Invalid JSON response from start upload\"\n                );\n                onError({\n                  type: \"error\",\n                  error,\n                  phase: \"start\",\n                  status: xhr.status,\n                  timestamp: new Date(),\n                });\n                reject(error);\n              }\n            } else {\n              let errorMessage;\n              try {\n                const errorResponse = JSON.parse(xhr.responseText);\n                errorMessage =\n                  errorResponse.message ||\n                  `Start upload failed with status ${xhr.status}`;\n              } catch (e) {\n                errorMessage =\n                  xhr.responseText ||\n                  `Start upload failed with status ${xhr.status}`;\n              }\n\n              const error = new Error(errorMessage);\n              onError({\n                type: \"error\",\n                error,\n                phase: \"start\",\n                status: xhr.status,\n                timestamp: new Date(),\n              });\n              reject(error);\n            }\n          };\n\n          xhr.onerror = () => {\n            const error = new Error(\"Start upload failed\");\n            onError({\n              type: \"error\",\n              error,\n              phase: \"start\",\n              timestamp: new Date(),\n            });\n            reject(error);\n          };\n\n          xhr.send(\n            JSON.stringify({\n              filename: file.name,\n              contentType: file.type,\n              size: file.size,\n            })\n          );\n        });\n\n      const { uploadId } = await startUpload();\n\n      // Calculate parts\n      const totalParts = Math.ceil(file.size / partSize);\n      const parts = [];\n      let uploadedBytes = 0;\n\n      // Upload parts with concurrency control\n      const uploadPart = async (partNumber) => {\n        const start = (partNumber - 1) * partSize;\n        const end = Math.min(start + partSize, file.size);\n        const chunk = file.slice(start, end);\n\n        const partUrl = await getSignedUrl(\"uploadpart\", {\n          uploadId,\n          partNumber,\n          key: file.name,\n          totalParts,\n        });\n\n        return new Promise((resolve, reject) => {\n          const xhr = new XMLHttpRequest();\n\n          if (signal?.aborted) {\n            reject(new Error(\"Upload aborted\"));\n            return;\n          }\n\n          xhr.upload.onprogress = (event) => {\n            if (event.lengthComputable) {\n              const partProgress = event.loaded / event.total;\n              const partSize = end - start;\n              const partLoaded = partSize * partProgress;\n\n              const totalProgress =\n                ((uploadedBytes + partLoaded) / file.size) * 100;\n\n              onProgress({\n                loaded: uploadedBytes + partLoaded,\n                total: file.size,\n                progress: totalProgress,\n                part: {\n                  number: partNumber,\n                  progress: partProgress * 100,\n                },\n              });\n            }\n          };\n\n          xhr.open(\"POST\", partUrl);\n\n          xhr.onload = () => {\n            if (xhr.status >= 200 && xhr.status < 300) {\n              const etag = xhr.getResponseHeader(\"ETag\");\n              uploadedBytes += chunk.size;\n\n              const part = {\n                ETag: etag,\n                PartNumber: partNumber,\n              };\n\n              onPartComplete(part);\n              resolve(part);\n            } else {\n              let errorMessage;\n              try {\n                const errorResponse = JSON.parse(xhr.responseText);\n                errorMessage =\n                  errorResponse.message ||\n                  `Part upload failed with status ${xhr.status}`;\n              } catch (e) {\n                errorMessage =\n                  xhr.responseText ||\n                  `Part upload failed with status ${xhr.status}`;\n              }\n\n              const error = new Error(errorMessage);\n              onError({\n                type: \"error\",\n                error,\n                phase: \"upload\",\n                partNumber,\n                status: xhr.status,\n                timestamp: new Date(),\n              });\n              reject(error);\n            }\n          };\n\n          xhr.onerror = () => reject(new Error(\"Part upload failed\"));\n          xhr.send(chunk);\n        });\n      };\n\n      // Upload parts with concurrency control\n      for (let i = 0; i < totalParts; i += concurrency) {\n        const partNumbers = Array.from(\n          { length: Math.min(concurrency, totalParts - i) },\n          (_, index) => i + index + 1\n        );\n\n        const uploadedParts = await Promise.all(\n          partNumbers.map((partNumber) => uploadPart(partNumber))\n        );\n        parts.push(...uploadedParts);\n      }\n\n      // Complete upload\n      const completeUrl = await getSignedUrl(\"completemultipart\", {\n        uploadId,\n        key: file.name,\n      });\n\n      const completeUpload = () =>\n        new Promise((resolve, reject) => {\n          const xhr = new XMLHttpRequest();\n\n          xhr.open(\"POST\", completeUrl);\n          xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n\n          xhr.onload = () => {\n            if (xhr.status >= 200 && xhr.status < 300) {\n              try {\n                const response = JSON.parse(xhr.responseText);\n                onComplete({\n                  type: \"complete\",\n                  response,\n                  timestamp: new Date(),\n                  file: {\n                    name: file.name,\n                    size: file.size,\n                    type: file.type,\n                  },\n                });\n                resolve(response);\n              } catch (e) {\n                const error = new Error(\n                  \"Invalid JSON response from complete upload\"\n                );\n                onError({\n                  type: \"error\",\n                  error,\n                  phase: \"complete\",\n                  status: xhr.status,\n                  timestamp: new Date(),\n                });\n                reject(error);\n              }\n            } else {\n              let errorMessage;\n              try {\n                const errorResponse = JSON.parse(xhr.responseText);\n                errorMessage =\n                  errorResponse.message ||\n                  `Complete upload failed with status ${xhr.status}`;\n              } catch (e) {\n                errorMessage =\n                  xhr.responseText ||\n                  `Complete upload failed with status ${xhr.status}`;\n              }\n\n              const error = new Error(errorMessage);\n              onError({\n                type: \"error\",\n                error,\n                phase: \"complete\",\n                status: xhr.status,\n                timestamp: new Date(),\n              });\n              reject(error);\n            }\n          };\n\n          xhr.onerror = () => {\n            const error = new Error(\"Complete upload failed\");\n            onError({\n              type: \"error\",\n              error,\n              phase: \"complete\",\n              timestamp: new Date(),\n            });\n            reject(error);\n          };\n\n          xhr.send(\n            JSON.stringify({\n              parts: parts.sort((a, b) => a.PartNumber - b.PartNumber),\n            })\n          );\n        });\n\n      return await completeUpload();\n    } catch (error) {\n      // If something goes wrong and we have an uploadId, try to cancel the upload\n      if (uploadId) {\n        try {\n          const cancelUrl = await getSignedUrl(\"cancelmultipart\", {\n            uploadId,\n            key: file.name,\n          });\n\n          await new Promise((resolve, reject) => {\n            const xhr = new XMLHttpRequest();\n            xhr.open(\"DELETE\", cancelUrl);\n            xhr.onload = () => (xhr.status < 300 ? resolve() : reject());\n            xhr.onerror = () => reject();\n            xhr.send();\n          });\n        } catch (cancelError) {\n          console.error(\"Failed to cancel multipart upload:\", cancelError);\n        }\n      }\n\n      onError({\n        type: \"error\",\n        error,\n        phase: \"upload\",\n        timestamp: new Date(),\n      });\n      throw error;\n    }\n  }\n\n  async uploadFile(\n    file,\n    getSignedUrl,\n    {\n      onProgress = () => {},\n      onComplete = () => {},\n      onError = () => {},\n      onStart = () => {},\n      signal,\n    } = {}\n  ) {\n    try {\n      // Get signed URL for upload\n      const signedUrl = await getSignedUrl(\"upload\", {\n        key: file.name,\n        mimeType: file.type,\n      });\n\n      const xhr = new XMLHttpRequest();\n\n      // Setup abort signal handler\n      if (signal?.aborted) {\n        onError({\n          type: \"abort\",\n          error: new Error(\"Upload aborted\"),\n          timestamp: new Date(),\n        });\n        throw new Error(\"Upload aborted\");\n      }\n\n      signal?.addEventListener(\"abort\", () => xhr.abort());\n\n      // Return promise for upload completion\n      return new Promise((resolve, reject) => {\n        xhr.open(\"PUT\", signedUrl);\n\n        // Setup progress tracking\n        xhr.upload.onprogress = (event) => {\n          if (event.lengthComputable) {\n            const percentComplete = (event.loaded / event.total) * 100;\n            onProgress({\n              loaded: event.loaded,\n              total: event.total,\n              progress: percentComplete,\n              type: \"progress\",\n            });\n          }\n        };\n\n        // Setup start handler\n        xhr.upload.onloadstart = () => {\n          onStart({\n            type: \"start\",\n            timestamp: new Date(),\n            file: {\n              name: file.name,\n              size: file.size,\n              type: file.type,\n            },\n          });\n        };\n\n        // Setup completion handler\n        xhr.onload = () => {\n          if (xhr.status >= 200 && xhr.status < 300) {\n            try {\n              const response = JSON.parse(xhr.responseText);\n              onComplete({\n                type: \"complete\",\n                response,\n                timestamp: new Date(),\n                file: {\n                  name: file.name,\n                  size: file.size,\n                  type: file.type,\n                },\n              });\n              resolve(response);\n            } catch (e) {\n              onComplete({\n                type: \"complete\",\n                response: xhr.responseText,\n                timestamp: new Date(),\n                file: {\n                  name: file.name,\n                  size: file.size,\n                  type: file.type,\n                },\n              });\n              resolve(xhr.responseText);\n            }\n          } else {\n            const error = new Error(`Upload failed with status ${xhr.status}`);\n            onError({\n              type: \"error\",\n              error,\n              status: xhr.status,\n              timestamp: new Date(),\n            });\n            reject(error);\n          }\n        };\n\n        xhr.onerror = () => {\n          const error = new Error(\"Upload failed\");\n          onError({\n            type: \"error\",\n            error,\n            timestamp: new Date(),\n          });\n          reject(error);\n        };\n\n        xhr.onabort = () => {\n          const error = new Error(\"Upload aborted\");\n          onError({\n            type: \"abort\",\n            error,\n            timestamp: new Date(),\n          });\n          reject(error);\n        };\n\n        // Create FormData and send\n        const formData = new FormData();\n        formData.append(\"file\", file);\n        xhr.send(formData);\n      });\n    } catch (error) {\n      onError({\n        type: \"error\",\n        error,\n        timestamp: new Date(),\n      });\n      throw error;\n    }\n  }\n}\n\nexport default ApexxCloud;\n"],"names":["ApexxCloud","constructor","config","baseUrl","files","upload","uploadFile","bind","uploadMultipart","file","getSignedUrl","onProgress","onPartComplete","onComplete","onError","partSize","signal","concurrency","startUrl","key","name","totalParts","Math","ceil","size","mimeType","type","startUpload","Promise","resolve","reject","xhr","XMLHttpRequest","aborted","error","Error","phase","timestamp","Date","open","setRequestHeader","onload","status","JSON","parse","responseText","e","errorMessage","errorResponse","message","onerror","send","stringify","filename","contentType","uploadId","parts","uploadedBytes","uploadPart","partNumber","start","end","min","chunk","slice","partUrl","onprogress","event","lengthComputable","partProgress","loaded","total","partLoaded","totalProgress","progress","part","number","etag","getResponseHeader","ETag","PartNumber","i","partNumbers","Array","from","length","_","index","uploadedParts","all","map","push","completeUrl","completeUpload","response","sort","a","b","onStart","signedUrl","addEventListener","abort","percentComplete","onloadstart","onabort","formData","FormData","append"],"mappings":"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"}